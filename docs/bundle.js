var app=function(){"use strict";function e(){}function t(e){return e()}function n(){return Object.create(null)}function o(e){e.forEach(t)}function r(e){return"function"==typeof e}function i(e,t){return e!=e?t==t:e!==t}function a(t,...n){if(null==t)return e;const o=t.subscribe(...n);return o.unsubscribe?()=>o.unsubscribe():o}function s(e,t){e.appendChild(t)}function c(e,t,n){e.insertBefore(t,n||null)}function u(e){e.parentNode.removeChild(e)}function d(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}function l(e){return document.createElement(e)}function f(e){return document.createTextNode(e)}function p(){return f(" ")}function g(e,t,n,o){return e.addEventListener(t,n,o),()=>e.removeEventListener(t,n,o)}function h(e,t,n){null==n?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function m(e,t){t=""+t,e.data!==t&&(e.data=t)}function b(e,t,n){e.classList[n?"add":"remove"](t)}let k;function y(e){k=e}function j(e){(function(){if(!k)throw new Error("Function called outside component initialization");return k})().$$.on_destroy.push(e)}const x=[],v=[],$=[],_=[],O=Promise.resolve();let S=!1;function D(e){$.push(e)}let M=!1;const w=new Set;function E(){if(!M){M=!0;do{for(let e=0;e<x.length;e+=1){const t=x[e];y(t),H(t.$$)}for(x.length=0;v.length;)v.pop()();for(let e=0;e<$.length;e+=1){const t=$[e];w.has(t)||(w.add(t),t())}$.length=0}while(x.length);for(;_.length;)_.pop()();S=!1,M=!1,w.clear()}}function H(e){if(null!==e.fragment){e.update(),o(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(D)}}const I=new Set;function N(e,t){-1===e.$$.dirty[0]&&(x.push(e),S||(S=!0,O.then(E)),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function P(i,a,s,c,d,l,f=[-1]){const p=k;y(i);const g=a.props||{},h=i.$$={fragment:null,ctx:null,props:l,update:e,not_equal:d,bound:n(),on_mount:[],on_destroy:[],before_update:[],after_update:[],context:new Map(p?p.$$.context:[]),callbacks:n(),dirty:f};let m=!1;if(h.ctx=s?s(i,g,(e,t,...n)=>{const o=n.length?n[0]:t;return h.ctx&&d(h.ctx[e],h.ctx[e]=o)&&(h.bound[e]&&h.bound[e](o),m&&N(i,e)),t}):[],h.update(),m=!0,o(h.before_update),h.fragment=!!c&&c(h.ctx),a.target){if(a.hydrate){const e=function(e){return Array.from(e.childNodes)}(a.target);h.fragment&&h.fragment.l(e),e.forEach(u)}else h.fragment&&h.fragment.c();a.intro&&((b=i.$$.fragment)&&b.i&&(I.delete(b),b.i(j))),function(e,n,i){const{fragment:a,on_mount:s,on_destroy:c,after_update:u}=e.$$;a&&a.m(n,i),D(()=>{const n=s.map(t).filter(r);c?c.push(...n):o(n),e.$$.on_mount=[]}),u.forEach(D)}(i,a.target,a.anchor),E()}var b,j;y(p)}let A;function T(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function R(e,t){return e(t={exports:{}},t.exports),t.exports}"function"==typeof HTMLElement&&(A=class extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){for(const e in this.$$.slotted)this.appendChild(this.$$.slotted[e])}attributeChangedCallback(e,t,n){this[e]=n}$destroy(){!function(e,t){const n=e.$$;null!==n.fragment&&(o(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}(this,1),this.$destroy=e}$on(e,t){const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(t),()=>{const e=n.indexOf(t);-1!==e&&n.splice(e,1)}}$set(){}});var C=R((function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n;!function(e){e[e.None=-1]="None",e[e.Up=0]="Up",e[e.Right=1]="Right",e[e.Down=2]="Down",e[e.Left=3]="Left",e[e.Space=4]="Space"}(n=t.InputKey||(t.InputKey={})),t.getInputKey=function(e){let t=n.None;return!function(e){return 87===e||38===e}(e)?!function(e){return 68===e||39===e}(e)?!function(e){return 83===e||40===e}(e)?!function(e){return 65===e||37===e}(e)?function(e){return 32===e}(e)&&(t=n.Space):t=n.Left:t=n.Down:t=n.Right:t=n.Up,t}}));T(C);C.InputKey,C.getInputKey;var F=R((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.None=-1]="None",e[e.North=0]="North",e[e.East=1]="East",e[e.South=2]="South",e[e.West=3]="West"}(t.Direction||(t.Direction={}))}));T(F);F.Direction;var G=R((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.MAP_WIDTH=20,t.MAP_HEIGHT=20;const n={isFood:!0,isSnake:!1,isSnakeHead:!1},o={isFood:!1,isSnake:!0,isSnakeHead:!1},r={isFood:!1,isSnake:!0,isSnakeHead:!0};function i(e,t,n){const o=e.grid[t][n];return!o.isFood&&!o.isSnake&&!o.isSnakeHead}function a(){return function(e){const n=[];for(let o=0;o<t.MAP_HEIGHT;o++){n[o]=[];for(let r=0;r<t.MAP_WIDTH;r++)n[o][r]=e(o,r)}return n}((e,t)=>({isFood:!1,isSnake:!1,isSnakeHead:!1}))}t.defaultMap=function(){return{grid:a()}},t.updateMap=function(e,t,i){const s=a();return s[i.i][i.j]=n,t.parts.forEach(e=>{s[e.i][e.j]=o}),s[t.head.i][t.head.j]=r,Object.assign(Object.assign({},e),{grid:s})},t.isInBorders=function(e,n,o){return n>=0&&n<t.MAP_HEIGHT&&o>=0&&o<t.MAP_WIDTH},t.isSnakeTile=function(e,t,n){return e.grid[t][n].isSnake},t.randomFood=function(e,n=!0){let o=e.food;if(n)for(;;){const n=Math.floor(Math.random()*t.MAP_HEIGHT),r=Math.floor(Math.random()*t.MAP_WIDTH);if(i(e.map,n,r)){o={i:n,j:r};break}}return o}}));T(G);G.MAP_WIDTH,G.MAP_HEIGHT,G.defaultMap,G.updateMap,G.isInBorders,G.isSnakeTile,G.randomFood;var W=R((function(e,t){function n(){const e={i:0,j:10},t=function(){const e=[{i:0,j:0},{i:0,j:1},{i:0,j:2}];return{direction:F.Direction.East,head:e[e.length-1],length:e.length,parts:e,foodEaten:!1}}();return{snake:t,map:G.updateMap(G.defaultMap(),t,e),food:e,gameOver:!1}}function o(e,t){(function(e,t){let n=!1;if(t!==F.Direction.None)switch(e){case F.Direction.North:n=t!==F.Direction.South;break;case F.Direction.East:n=t!==F.Direction.West;break;case F.Direction.South:n=t!==F.Direction.North;break;case F.Direction.West:n=t!==F.Direction.East;break;case F.Direction.None:n=!1}return n})(e.direction,t)&&(e=Object.assign(Object.assign({},e),{direction:t}));const n=function(e){const t=e.head;let n=t;switch(e.direction){case F.Direction.North:n={i:t.i-1,j:t.j};break;case F.Direction.East:n={i:t.i,j:t.j+1};break;case F.Direction.South:n={i:t.i+1,j:t.j};break;case F.Direction.West:n={i:t.i,j:t.j-1}}return n}(e);return e.parts=[...e.parts,n],Object.assign(Object.assign({},e),{head:n,parts:e.parts,length:e.parts.length})}function r(e,t){const n=e.head.i===t.i&&e.head.j===t.j;let o=e.parts,[r,...i]=e.parts;return n||(o=i),Object.assign(Object.assign({},e),{foodEaten:n,parts:o,length:o.length})}function i(e){const{snake:t,snake:{head:n}}=e;return!G.isInBorders(e.map,n.i,n.j)||t.parts.some(e=>e!==n&&e.i===n.i&&e.j===n.j)}function a(e){return function(e){let t=F.Direction.None;switch(e){case C.InputKey.Left:t=F.Direction.West;break;case C.InputKey.Right:t=F.Direction.East;break;case C.InputKey.Down:t=F.Direction.South;break;case C.InputKey.Up:t=F.Direction.North}return t}(C.getInputKey(e.keyCode))}Object.defineProperty(t,"__esModule",{value:!0}),t.defaultGameState=function(){return{game:n(),directions:[F.Direction.East],shouldRender:!0}},t.tickReducer=function(e){if(e.game.gameOver)return e;const[t,n,...a]=e.directions;let s=t;void 0!==n&&(s=n);const c=1===e.directions.length?e.directions:[n,...a],u=function(e,t){return e=Object.assign(Object.assign({},e),{snake:o(e.snake,t)}),e=Object.assign(Object.assign({},e),{snake:r(e.snake,e.food)}),e=Object.assign(Object.assign({},e),{food:G.randomFood(e,e.snake.foodEaten)}),(e=Object.assign(Object.assign({},e),{gameOver:i(e)})).gameOver||(e=Object.assign(Object.assign({},e),{map:G.updateMap(e.map,e.snake,e.food)})),e}(e.game,s);return Object.assign(Object.assign({},e),{game:u,directions:c,shouldRender:!0})},t.directionReducer=function(e,t){let n=e;const o=a(t),r=e.directions[e.directions.length-1];return o!==F.Direction.None&&o!==r&&(n=Object.assign(Object.assign({},e),{directions:[...e.directions,o],shouldRender:!1})),n},t.renderConsole=function(e){if(e.shouldRender&&!e.game.gameOver){const t=e.game.map.grid.map(e=>e.map(e=>e.isSnakeHead?"@":e.isSnake?"x":e.isFood?"*":".").join(" ")).join("\n");console.log(t+"\n")}}}));T(W);W.defaultGameState;var K=W.tickReducer,L=W.directionReducer;W.renderConsole;const B=[];function U(e,t){return{subscribe:z(e,t).subscribe}}function z(t,n=e){let o;const r=[];function i(e){if(i=e,((n=t)!=n?i==i:n!==i||n&&"object"==typeof n||"function"==typeof n)&&(t=e,o)){const e=!B.length;for(let e=0;e<r.length;e+=1){const n=r[e];n[1](),B.push(n,t)}if(e){for(let e=0;e<B.length;e+=2)B[e][0](B[e+1]);B.length=0}}var n,i}return{set:i,update:function(e){i(e(t))},subscribe:function(a,s=e){const c=[a,s];return r.push(c),1===r.length&&(o=n(i)||e),a(t),()=>{const e=r.indexOf(c);-1!==e&&r.splice(e,1),0===r.length&&(o(),o=null)}}}}var q,J=(q=Object.freeze({__proto__:null,derived:function(t,n,i){const s=!Array.isArray(t),c=s?[t]:t,u=n.length<2;return U(i,t=>{let i=!1;const d=[];let l=0,f=e;const p=()=>{if(l)return;f();const o=n(s?d[0]:d,t);u?t(o):f=r(o)?o:e},g=c.map((e,t)=>a(e,e=>{d[t]=e,l&=~(1<<t),i&&p()},()=>{l|=1<<t}));return i=!0,p(),function(){o(g),f()}})},readable:U,writable:z,get:function(e){let t;return a(e,e=>t=e)(),t}}))&&q.default||q,Q=R((function(e,t){Object.defineProperty(t,"__esModule",{value:!0});const n=W.defaultGameState();t.Store=class{constructor(){this.state=J.writable(n)}select(){return this.state}reduce(e){this.state.update(e)}reset(){this.state.set(n)}}}));T(Q);var V=Q.Store;function X(e,t,n){const o=e.slice();return o[15]=t[n],o}function Y(e,t,n){const o=e.slice();return o[12]=t[n],o[14]=n,o}function Z(t){let n,o;return{c(){n=l("button"),n.textContent="Pause Game"},m(e,r,i){c(e,n,r),i&&o(),o=g(n,"click",t[6])},p:e,d(e){e&&u(n),o()}}}function ee(t){let n,o;return{c(){n=l("button"),n.textContent="Start Game"},m(e,r,i){c(e,n,r),i&&o(),o=g(n,"click",t[5])},p:e,d(e){e&&u(n),o()}}}function te(e){let t;return{c(){var n,o,r,i;t=l("div"),h(t,"class","tile"),n=t,o="grid-row",r=e[14]+1,n.style.setProperty(o,r,i?"important":""),b(t,"food",e[15].isFood),b(t,"snake",e[15].isSnake),b(t,"head",e[15].isSnakeHead)},m(e,n){c(e,t,n)},p(e,n){2&n&&b(t,"food",e[15].isFood),2&n&&b(t,"snake",e[15].isSnake),2&n&&b(t,"head",e[15].isSnakeHead)},d(e){e&&u(t)}}}function ne(e){let t,n=e[12],o=[];for(let t=0;t<n.length;t+=1)o[t]=te(X(e,n,t));return{c(){for(let e=0;e<o.length;e+=1)o[e].c();t=f("")},m(e,n){for(let t=0;t<o.length;t+=1)o[t].m(e,n);c(e,t,n)},p(e,r){if(2&r){let i;for(n=e[12],i=0;i<n.length;i+=1){const a=X(e,n,i);o[i]?o[i].p(a,r):(o[i]=te(a),o[i].c(),o[i].m(t.parentNode,t))}for(;i<o.length;i+=1)o[i].d(1);o.length=n.length}},d(e){d(o,e),e&&u(t)}}}function oe(e){let t,n,o,r,i,a,d,b,k;return{c(){t=l("div"),n=l("span"),n.textContent="Game Over",o=p(),r=l("span"),i=f("Score: "),a=f(e[2]),d=p(),b=l("button"),b.textContent="Reset",h(b,"class","snake-reset"),h(t,"class","game-over")},m(u,l,f){c(u,t,l),s(t,n),s(t,o),s(t,r),s(r,i),s(r,a),s(t,d),s(t,b),f&&k(),k=g(b,"click",e[7])},p(e,t){4&t&&m(a,e[2])},d(e){e&&u(t),k()}}}function re(t){let n,o,r,i,a,b,k,y,j,x,v,$,_,O;function S(e,t){return e[0]?Z:ee}let D=S(t),M=D(t),w=t[1],E=[];for(let e=0;e<w.length;e+=1)E[e]=ne(Y(t,w,e));let H=t[3]&&oe(t);return{c(){n=l("div"),o=l("div"),r=l("h1"),r.textContent="Snake",i=p(),a=l("span"),b=f("Score: "),k=f(t[2]),y=p(),j=l("div"),M.c(),x=p(),v=l("div"),$=l("div");for(let e=0;e<E.length;e+=1)E[e].c();_=p(),H&&H.c(),this.c=e,h(r,"class","game-title"),h(a,"class","game-score"),h(j,"class","game-info-container"),h(o,"class","game-header-container"),h($,"class","snake-grid"),h(v,"class","snake-grid-container"),h(n,"class","game-container")},m(e,u,d){c(e,n,u),s(n,o),s(o,r),s(o,i),s(o,a),s(a,b),s(a,k),s(o,y),s(o,j),M.m(j,null),s(n,x),s(n,v),s(v,$);for(let e=0;e<E.length;e+=1)E[e].m($,null);s(v,_),H&&H.m(v,null),d&&O(),O=g(window,"keydown",t[4])},p(e,[t]){if(4&t&&m(k,e[2]),D===(D=S(e))&&M?M.p(e,t):(M.d(1),M=D(e),M&&(M.c(),M.m(j,null))),2&t){let n;for(w=e[1],n=0;n<w.length;n+=1){const o=Y(e,w,n);E[n]?E[n].p(o,t):(E[n]=ne(o),E[n].c(),E[n].m($,null))}for(;n<E.length;n+=1)E[n].d(1);E.length=w.length}e[3]?H?H.p(e,t):(H=oe(e),H.c(),H.m(v,null)):H&&(H.d(1),H=null)},i:e,o:e,d(e){e&&u(n),M.d(),d(E,e),H&&H.d(),O()}}}function ie(e,t,n){const o=new V;let r,i,a=!1;function s(){n(0,a=!1),clearInterval(i)}let c,u,d;return j(o.select().subscribe(e=>{n(8,r=e)})),e.$$.update=()=>{256&e.$$.dirty&&n(1,c=r.game.map.grid),256&e.$$.dirty&&n(2,u=r.game.snake.length-3),256&e.$$.dirty&&n(3,d=r.game.gameOver)},[a,c,u,d,function(e){a&&o.reduce(t=>L(t,e))},function(){n(0,a=!0),i=setInterval(()=>{o.reduce(K)},150)},s,function(){s(),o.reset()}]}class ae extends A{constructor(e){super(),this.shadowRoot.innerHTML="<style>.game-container{display:block;width:max-content;font-family:sans-serif}button{font-family:inherit}.game-header-container{display:flex}.game-title{margin:0;flex:1}.game-score{display:flex;align-items:center}.game-info-container{flex:1;display:flex;align-items:center;justify-content:flex-end}.snake-grid-container{position:relative;display:flex;align-items:center;justify-content:center}.snake-grid{display:grid;background:#dedede;grid-gap:1px 1px;border:solid 1px #dedede;border-radius:5px}.tile{width:20px;height:20px;border-radius:5px;background:white}.tile.snake{background:green}.tile.food{background:red}.tile.head{background:purple}.game-over{position:absolute;padding:20px;box-shadow:0 0 10px 2px #dedede;border:1px solid #dedede;background:white;text-align:center;opacity:0.8;border-radius:5px;width:169px;height:85px;cursor:default;display:flex;flex-direction:column;align-items:center;justify-content:center}.snake-reset{margin-top:10px}</style>",P(this,{target:this.shadowRoot},ie,re,i,{}),e&&e.target&&c(e.target,this,e.anchor)}}return customElements.define("svelte-snake",ae),ae}();
//# sourceMappingURL=bundle.js.map
